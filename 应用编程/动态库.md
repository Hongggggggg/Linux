- 生成动态库文件

  ```bash
  gcc -fPIC -shared *c -o libTest.so
  ```

  - -fPIC选项

    ​	PIC  -Position Independent Code，意思是位置无关码，即加载器把其加载到内存任何位置，其代码均可正常运行，所以代码中都是使用的相对地址，这样的特点也就非常满足动态库加载位置变化的特性。

    ​	同时这样的特点也让动态库被多个应用成需连接的时候不需要copy形成多个副本，大大节省内存。

  - -shared选项

    该选项主要是把目标文件链接成为一个共享库
    
    

- 使用库文件编译

  ```bash
  gcc test.c -o test -lTest -L.	#和静态库一致
  ```

  

- 动态库的使用

  ​	如果直接运行可执行文件，系统会提示无法打开共享文件，是由于共享库没有在系统加载器所指定的路径中

  ​	一般加载器都会默认在“/lib”、“/usr/lib”或者LD_LIBRARY_PATH环境变量指定的路径中搜索动态库，所以如果把.so文件复制到前两个目录便可执行，通常为了不破坏系统文件，一般都会使用环境变量定义路径:

  ```bash
  export LD_LIBRARY_PATH="."
  ./test
  ```

  

